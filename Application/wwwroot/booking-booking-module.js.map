{"version":3,"sources":["./src/app/booking/bookseats/bookseats.component.ts","./src/app/booking/bookseats/bookseats.component.html","./src/app/booking/booking-routing.module.ts","./src/app/booking/booking.module.ts"],"names":[],"mappings":"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","file":"booking-booking-module.js","sourcesContent":["import { HttpErrorResponse } from '@angular/common/http';\nimport { Theatre } from './../../Models/models';\nimport { NotificationService } from './../../Services/notification.service';\nimport { ApiService } from './../../Services/apiservice.service';\nimport { Component, ElementRef, OnInit, ViewChild } from '@angular/core';\nimport { ActivatedRoute, Router } from '@angular/router';\nimport { Movie, Seat } from 'src/app/Models/models';\nimport { FormControl, FormGroup } from '@angular/forms';\nimport { ModalDismissReasons, NgbModal } from '@ng-bootstrap/ng-bootstrap';\nimport { map } from 'rxjs/operators';\n\n@Component({\n  selector: 'app-bookseats',\n  templateUrl: './bookseats.component.html',\n})\nexport class BookSeatsComponent implements OnInit {\n  movie: Movie = new Movie();\n  theatres = [];\n  formGroup: FormGroup;\n  seats: Seat[] = [];\n  seatsBooking: number[] = [];\n  priceToPay:number;\n\n  @ViewChild('seatsRef', { static: true }) seatsRef: ElementRef;\n  closeResult: string;\n\n  constructor(\n    private activeRoute: ActivatedRoute,\n    private apiService: ApiService,\n    private modalService: NgbModal,\n    private notService:NotificationService,\n    private router:Router\n  ) {}\n\n  ngOnInit(): void {\n    this.formGroup = new FormGroup({\n      select: new FormControl('none'),\n    });\n\n    this.activeRoute.params.subscribe((params) => {\n      let movieId = Number(params['id']);\n      this.apiService.GetMovieDetail(movieId).subscribe((response) => {\n        this.movie = response;\n      });\n\n      this.apiService.GetTheatres(movieId).subscribe((response) => {\n        for (let key in response) {\n          this.theatres.push({\n            id: response[key]['id'],\n            theatreName: response[key]['theaterName'],\n          });\n        }\n      });\n    });\n  }\n\n  navigate(content) {\n    let theaterId = this.formGroup.get('select').value;\n    this.apiService.GetSeats(theaterId).subscribe((response) => {\n      this.seats = [];\n      for (let key in response) {\n        let s = new Seat();\n        s.Id = response[key].id;\n        s.occupied = response[key].occupied;\n        this.seats.push(s);\n      }\n    });\n    \n    this.seatsBooking = [];\n    this.open(content);\n  }\n\n  open(content) {\n    this.modalService\n      .open(content, { ariaLabelledBy: 'modal-basic-title' })\n      .result.then(\n        (result) => {\n          this.closeResult = `Closed with: ${result}`;\n        },\n        (reason) => {\n          this.closeResult = `Dismissed ${this.getDismissReason(reason)}`;\n        }\n      );\n  }\n  private getDismissReason(reason: any): string {\n    if (reason === ModalDismissReasons.ESC) {\n      return 'by pressing ESC';\n    } else if (reason === ModalDismissReasons.BACKDROP_CLICK) {\n      return 'by clicking on a backdrop';\n    } else {\n      return `with: ${reason}`;\n    }\n  }\n\n  bookSeats() {\n    console.log(this.seatsBooking);\n    this.apiService\n      .BookSeats(this.seatsBooking, this.movie.id,this.formGroup.get('select').value)\n      .subscribe(\n        response=>{\n          console.log(response);\n        },\n        (error:HttpErrorResponse)=>{\n          this.notService.showError(error.message,\"Error\");\n        },\n        ()=>{\n          this.notService.showSuccess(`Seats Booked.`,'Success');\n          this.seatsBooking = [];\n          this.modalService.dismissAll();\n        }\n      );\n  }\n\n  bookSeat(seat:Seat){\n    if(seat.occupied){\n      return;\n    }\n    seat.booked = seat.occupied?false:seat.booked?false:true;\n    let index = this.seatsBooking.indexOf(seat.Id);\n    if(index>-1){\n      this.seatsBooking.splice(index);\n    }else{\n      this.seatsBooking.push(seat.Id);\n    }\n  }\n}\n","<div class=\"px-3 d-flex flex-wrap container-fluid bg-dark text-white mt-4\">\n  <div class=\"mt-4\">\n    <img src=\"{{ movie.imageUrl }}\" alt=\"{{ movie.title }}\" class=\"img-fluidimg-thumbnail ml-4\" style=\"max-width: 300px;\n    -webkit-box-shadow: -2px 1px 11px 8px #FAEBFF; \n      box-shadow: -2px 1px 11px 8px #FAEBFF;\" />\n  </div>\n  <form [formGroup]=\"formGroup\" class=\"pl-4 flex-grow\" style=\"max-width: 900px\">\n\n    <div class=\"display-3 my-4\">{{ movie.title }}</div>\n\n    <div class=\"form-group\">\n      <select name=\"selectTheatre\" id=\"\" class=\"form-control bg-dark text-white\" aria-valuetext=\"select\"\n        style=\"max-width: 350px; min-width: 300px\" (ngModelChange)=\"navigate(content)\" formControlName=\"select\">\n        <option value=\"none\" disabled>SELECT THEATRE</option>\n        <option [value]=\"theatre.id\" *ngFor=\"let theatre of theatres\">\n          {{ theatre.theatreName }}\n        </option>\n      </select>\n    </div>\n    <h4 class=\"mb-4\">Price: {{ movie.price | currency: \"₹\" }}</h4>\n  </form>\n</div>\n\n<ng-template #content let-modal style=\"width: 400px; position: absolute !important; top: 0; left: 0;\">\n  <div class=\"modal-header\">\n    <h4 class=\"modal-title\" id=\"modal-basic-title\">SEATS</h4>\n    <button type=\"button\" class=\"close\" aria-label=\"Close\" (click)=\"modal.dismiss('Cross click'); \">\n      <span aria-hidden=\"true\" class=\"text-white\">&times;</span>\n    </button>\n  </div>\n  <div class=\"modal-body\">\n    <div class=\"py-4\">\n      <div class=\"d-flex flex-wrap m-0 p-0\" style=\"max-width: 400px\">\n        <div style=\"\n        display: grid;\n        width: 40px;\n        height: 40px;\n        place-items: center;\n        border-radius: 50%;\n        color: white;\n        background-color: dodgerblue;\n      \" class=\"mr-2 free my-2\" [ngClass]=\"{ occupied: seat.occupied,seat:!seat.occupied,booked:seat.booked }\"\n          *ngFor=\"let seat of seats;let index = index\"\n          (click)=\"bookSeat(seat)\">\n          {{ seat.Id }}\n        </div>\n      </div>\n    </div>\n    <div class=\"modal-footer d-flex\">\n      <h4>Total Price:{{seatsBooking.length * movie.price | currency:\"₹\"}}</h4>\n      <button class=\"btn btn-danger ml-auto\" (click)=\"bookSeats()\">Book Tickets</button>\n    </div>\n  </div>\n</ng-template>","import { BookSeatsComponent } from './bookseats/bookseats.component';\nimport { NgModule } from '@angular/core';\nimport { Routes, RouterModule } from '@angular/router';\n\nconst routes: Routes = [\n  {\n    path: '',\n    component: BookSeatsComponent,\n  },\n];\n\n@NgModule({\n  imports: [RouterModule.forChild(routes)],\n  exports: [RouterModule],\n})\nexport class BookingRoutingModule {}\n","import { NgModule } from '@angular/core';\nimport { CommonModule } from '@angular/common';\n\nimport { BookingRoutingModule } from './booking-routing.module';\nimport { BookSeatsComponent } from './bookseats/bookseats.component';\nimport { ReactiveFormsModule } from '@angular/forms';\n\n@NgModule({\n  declarations: [BookSeatsComponent],\n  imports: [CommonModule, BookingRoutingModule, ReactiveFormsModule],\n})\nexport class BookingModule {}\n"],"sourceRoot":"webpack:///"}